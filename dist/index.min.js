!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@babel/runtime/helpers/extends"),require("d3-ease"),require("prop-types"),require("react"),require("d3-hierarchy")):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/extends","d3-ease","prop-types","react","d3-hierarchy"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactTreeGraph={},e._extends,e.d3,e.PropTypes,e.React,e.d3)}(this,(function(e,t,r,a,i,d){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var o=s(t),n=s(a),u=s(i);function l(e){const t=e.margins||{bottom:10,left:"rtl"!==e.direction?20:150,right:"rtl"!==e.direction?150:20,top:10},r=e.width-t.left-t.right,a=e.height-t.top-t.bottom,i=d.hierarchy(e.data,e.getChildren),s=d.tree().size([a,r])(i);return{links:s.links().map((t=>({...t,source:{...t.source,x:"rtl"!==e.direction?t.source.y:r-t.source.y,y:t.source.x},target:{...t.target,x:"rtl"!==e.direction?t.target.y:r-t.target.y,y:t.target.x}}))),margins:t,nodes:s.descendants().map((t=>({...t,x:"rtl"!==e.direction?t.y:r-t.y,y:t.x})))}}const p=/on[A-Z]/;function f(e,t){return r=>e(r,...t)}function c(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const i=Object.keys(e).filter((t=>p.test(t)&&"function"==typeof e[t])),d=i.reduce(((t,a)=>(t[a]=f(e[a],r),t)),{});return{...e,...d}}function h(e){const t=c(e.pathProps,e.source.data[e.keyProp],e.target.data[e.keyProp]),r=e.pathFunc(e.x1,e.y1,e.x2,e.y2);return u.default.createElement("path",o.default({},t,{d:r}))}function g(e){let t=.5,r=e.nodeProps;switch(e.shape){case"circle":r={r:5,...r},t+=r.r;break;case"image":case"rect":r={height:10,width:10,...r},r={x:-r.width/2,y:-r.height/2,...r},t+=r.width/2}"rtl"===e.direction&&(t=-t);const a=c(r,e[e.keyProp]),i=c(e.gProps,e[e.keyProp]),d=c(e.textProps,e[e.keyProp]),s="string"==typeof e[e.labelProp]?u.default.createElement("text",o.default({dx:t,dy:5},d),e[e.labelProp]):u.default.createElement("g",o.default({transform:`translate(${t}, 5)`},d),e[e.labelProp]);return u.default.createElement("g",o.default({},i,{transform:`translate(${e.x}, ${e.y})`,direction:"rtl"===e.direction?"rtl":null}),e.customVideo?u.default.createElement("foreignObject",a,u.default.createElement("video",{width:a.width,height:a.height,preload:"metadata",controls:!0},u.default.createElement("source",{src:`${e.videoPath}${e.name}`,type:"video/mp4"}))):u.default.createElement(u.default.Fragment,null,u.default.createElement(e.shape,a)," ",s))}function P(e){return u.default.createElement("svg",o.default({},e.svgProps,{height:e.height,width:e.width}),e.children,u.default.createElement("g",{transform:`translate(${e.margins.left}, ${e.margins.top})`},e.links.map((t=>u.default.createElement(h,{key:t.target.data[e.keyProp],keyProp:e.keyProp,pathFunc:e.pathFunc,source:t.source,target:t.target,x1:t.source.x,x2:t.target.x,y1:t.source.y,y2:t.target.y,pathProps:{...e.pathProps,...t.target.data.pathProps}}))),e.nodes.map((t=>u.default.createElement(g,o.default({key:t.data[e.keyProp],keyProp:e.keyProp,labelProp:e.labelProp,direction:e.direction,shape:e.nodeShape,x:t.x,y:t.y},t.data,{nodeProps:{...e.nodeProps,...t.data.nodeProps},gProps:{...e.gProps,...t.data.gProps},textProps:{...e.textProps,...t.data.textProps}}))))))}function y(e){const t=e.nodes[0].x,r=e.nodes[0].y,[a,d]=i.useState({nodes:e.nodes.map((e=>({...e,x:t,y:r}))),links:e.links.map((e=>({source:{...e.source,x:t,y:r},target:{...e.target,x:t,y:r}})))}),[s,n]=i.useState(null);function l(t,r,a){let i=t;for(;i;){let t=a.nodes.find((e=>p(i,e)));if(t)return t;i=r.nodes.find((t=>(e.getChildren(t)||[]).some((e=>p(i,e)))))}return a.nodes[0]}function p(t,r){return t.data[e.keyProp]===r.data[e.keyProp]}function f(t,r){return t.source.data[e.keyProp]===r.source.data[e.keyProp]&&t.target.data[e.keyProp]===r.target.data[e.keyProp]}function c(t,r,a){return t+(r-t)*e.easing(a)}return i.useEffect((function(){clearInterval(s);let t=0;const r=function(e,t){const r=t.nodes.filter((t=>e.nodes.every((e=>!p(t,e))))).map((r=>({base:r,old:l(r,t,e),new:r}))),a=t.nodes.filter((t=>e.nodes.some((e=>p(t,e))))).map((t=>({base:t,old:e.nodes.find((e=>p(t,e))),new:t}))),i=e.nodes.filter((e=>t.nodes.every((t=>!p(e,t))))).map((r=>({base:r,old:r,new:l(r,e,t)}))),d=t.links.filter((t=>e.links.every((e=>!f(t,e))))).map((r=>({base:r,old:l(r.target,t,e),new:r}))),s=t.links.filter((t=>e.links.some((e=>f(t,e))))).map((t=>({base:t,old:e.links.find((e=>f(t,e))),new:t}))),o=e.links.filter((e=>t.links.every((t=>!f(e,t))))).map((r=>({base:r,old:r,new:l(r.target,e,t)})));return{nodes:a.concat(r).concat(i),links:s.concat(d).concat(o)}}(a,e),i=setInterval((()=>{if(t++,t===e.steps)return clearInterval(i),void d({nodes:e.nodes,links:e.links});d(function(e,t){return{nodes:e.nodes.map((e=>function(e,t,r,a){return{...e,x:c(t.x,r.x,a),y:c(t.y,r.y,a)}}(e.base,e.old,e.new,t))),links:e.links.map((e=>function(e,t,r,a){return{source:{...e.source,x:c(t.source?t.source.x:t.x,r.source?r.source.x:r.x,a),y:c(t.source?t.source.y:t.y,r.source?r.source.y:r.y,a)},target:{...e.target,x:c(t.target?t.target.x:t.x,r.target?r.target.x:r.x,a),y:c(t.target?t.target.y:t.y,r.target?r.target.y:r.y,a)}}}(e.base,e.old,e.new,t)))}}(r,t/e.steps))}),e.duration/e.steps);return n(i),()=>clearInterval(s)}),[e.nodes,e.links]),u.default.createElement(P,o.default({},e,a))}function m(e){return u.default.createElement(y,o.default({duration:e.duration,easing:e.easing,getChildren:e.getChildren,direction:e.direction,height:e.height,keyProp:e.keyProp,labelProp:e.labelProp,nodeShape:e.nodeShape,nodeProps:e.nodeProps,pathFunc:e.pathFunc,steps:e.steps,width:e.width,gProps:{className:"node",...e.gProps},pathProps:{className:"link",...e.pathProps},svgProps:e.svgProps,textProps:e.textProps},l(e)),e.children)}function b(e){return u.default.createElement(P,o.default({getChildren:e.getChildren,direction:e.direction,height:e.height,keyProp:e.keyProp,labelProp:e.labelProp,nodeShape:e.nodeShape,nodeProps:e.nodeProps,pathFunc:e.pathFunc,width:e.width,gProps:{className:"node",...e.gProps},pathProps:{className:"link",...e.pathProps},svgProps:e.svgProps,textProps:e.textProps},l(e)),e.children)}h.propTypes={source:n.default.object.isRequired,target:n.default.object.isRequired,keyProp:n.default.string.isRequired,x1:n.default.number.isRequired,x2:n.default.number.isRequired,y1:n.default.number.isRequired,y2:n.default.number.isRequired,pathFunc:n.default.func.isRequired,pathProps:n.default.object.isRequired},h.defaultProps={pathFunc:function(e,t,r,a){return`M${e},${t}C${(e+r)/2},${t} ${(e+r)/2},${a} ${r},${a}`}},g.propTypes={x:n.default.number.isRequired,y:n.default.number.isRequired,keyProp:n.default.string.isRequired,labelProp:n.default.string.isRequired,direction:n.default.oneOf(["ltr","rtl"]).isRequired,shape:n.default.string.isRequired,nodeProps:n.default.object.isRequired,gProps:n.default.object.isRequired,textProps:n.default.object.isRequired,videoPath:n.default.string,name:n.default.string,customVideo:n.default.bool},P.propTypes={children:n.default.node,direction:n.default.oneOf(["ltr","rtl"]).isRequired,height:n.default.number.isRequired,keyProp:n.default.string.isRequired,labelProp:n.default.string.isRequired,links:n.default.array.isRequired,margins:n.default.shape({left:n.default.number.isRequired,top:n.default.number.isRequired}).isRequired,nodes:n.default.array.isRequired,nodeClassName:n.default.string,nodeShape:n.default.string.isRequired,nodeProps:n.default.object.isRequired,pathFunc:n.default.func,width:n.default.number.isRequired,gProps:n.default.object.isRequired,pathProps:n.default.object.isRequired,svgProps:n.default.object.isRequired,textProps:n.default.object.isRequired},y.propTypes={getChildren:n.default.func.isRequired,keyProp:n.default.string.isRequired,links:n.default.array.isRequired,nodes:n.default.array.isRequired,duration:n.default.number.isRequired,easing:n.default.func.isRequired,steps:n.default.number.isRequired},m.propTypes={data:n.default.object.isRequired,children:n.default.node,direction:n.default.oneOf(["ltr","rtl"]).isRequired,duration:n.default.number.isRequired,easing:n.default.func.isRequired,steps:n.default.number.isRequired,height:n.default.number.isRequired,width:n.default.number.isRequired,keyProp:n.default.string.isRequired,labelProp:n.default.string.isRequired,getChildren:n.default.func.isRequired,margins:n.default.shape({bottom:n.default.number.isRequired,left:n.default.number.isRequired,right:n.default.number.isRequired,top:n.default.number.isRequired}),pathFunc:n.default.func,nodeShape:n.default.oneOf(["circle","image","polygon","rect"]).isRequired,nodeProps:n.default.object.isRequired,gProps:n.default.object.isRequired,pathProps:n.default.object.isRequired,svgProps:n.default.object.isRequired,textProps:n.default.object.isRequired},m.defaultProps={direction:"ltr",duration:500,easing:r.easeQuadOut,getChildren:e=>e.children,steps:20,keyProp:"name",labelProp:"name",nodeShape:"circle",nodeProps:{},gProps:{},pathProps:{},svgProps:{},textProps:{}},b.propTypes={data:n.default.object.isRequired,children:n.default.node,direction:n.default.oneOf(["ltr","rtl"]).isRequired,height:n.default.number.isRequired,width:n.default.number.isRequired,keyProp:n.default.string.isRequired,labelProp:n.default.string.isRequired,getChildren:n.default.func.isRequired,margins:n.default.shape({bottom:n.default.number.isRequired,left:n.default.number.isRequired,right:n.default.number.isRequired,top:n.default.number.isRequired}),pathFunc:n.default.func,nodeShape:n.default.oneOf(["circle","image","polygon","rect"]).isRequired,nodeProps:n.default.object.isRequired,gProps:n.default.object.isRequired,pathProps:n.default.object.isRequired,svgProps:n.default.object.isRequired,textProps:n.default.object.isRequired},b.defaultProps={direction:"ltr",getChildren:e=>e.children,keyProp:"name",labelProp:"name",nodeShape:"circle",nodeProps:{},gProps:{},pathProps:{},svgProps:{},textProps:{}},e.AnimatedTree=m,e.Tree=b,Object.defineProperty(e,"__esModule",{value:!0})}));
