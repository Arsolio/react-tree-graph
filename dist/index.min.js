!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@babel/runtime/helpers/extends"),require("d3-ease"),require("prop-types"),require("react"),require("d3-hierarchy")):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/extends","d3-ease","prop-types","react","d3-hierarchy"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactTreeGraph={},e._extends,e.d3,e.PropTypes,e.React,e.d3)}(this,(function(e,t,r,a,s,d){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=i(t),u=i(a),o=i(s);function l(e){const t=e.width-e.margins.left-e.margins.right,r=e.height-e.margins.top-e.margins.bottom;let a=d.hierarchy(e.data,e.getChildren),s=d.tree().size([r,t])(a),i=s.descendants(),n=s.links();return i.forEach((t=>{t.y+=e.margins.top})),{nodes:i,links:n}}const p=/on[A-Z]/;function f(e,t){return r=>e(r,...t)}function c(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const s=Object.keys(e).filter((t=>p.test(t)&&"function"==typeof e[t])),d=s.reduce(((t,a)=>(t[a]=f(e[a],r),t)),{});return{...e,...d}}function h(e){const t=c(e.pathProps,e.source.data[e.keyProp],e.target.data[e.keyProp]),r=e.pathFunc(e.x1,e.y1,e.x2,e.y2);return o.default.createElement("path",n.default({},t,{d:r}))}function g(e){let t=0,r=e.nodeProps;switch(e.shape){case"circle":r={r:5,...r},t=r.r;break;case"image":case"rect":r={height:10,width:10,...r},r={x:-r.width/2,y:-r.height/2,...r},t=r.width/2}const a=c(r,e[e.keyProp]),s=c(e.gProps,e[e.keyProp]),d=c(e.textProps,e[e.keyProp]),i="string"==typeof e[e.labelProp]?o.default.createElement("text",n.default({dx:t+.5,dy:5},d),e[e.labelProp]):o.default.createElement("g",n.default({transform:`translate(${t+.5}, 5)`},d),e[e.labelProp]);return o.default.createElement("g",n.default({},s,{transform:`translate(${e.y}, ${e.x})`}),o.default.createElement(e.shape,a),i)}function P(e){return o.default.createElement("svg",n.default({},e.svgProps,{height:e.height,width:e.width}),e.children,o.default.createElement("g",null,e.links.map((t=>o.default.createElement(h,{key:t.target.data[e.keyProp],keyProp:e.keyProp,pathFunc:e.pathFunc,source:t.source,target:t.target,x1:t.source.x,x2:t.target.x,y1:t.source.y,y2:t.target.y,pathProps:{...e.pathProps,...t.target.data.pathProps}}))),e.nodes.map((t=>o.default.createElement(g,n.default({key:t.data[e.keyProp],keyProp:e.keyProp,labelProp:e.labelProp,shape:e.nodeShape,x:t.x,y:t.y,nodeProps:{...e.nodeProps,...t.data.nodeProps},gProps:{...e.gProps,...t.data.gProps},textProps:{...e.textProps,...t.data.textProps}},t.data))))))}function y(e){let t=null,r=e.nodes[0].x,a=e.nodes[0].y;const[d,i]=s.useState({nodes:e.nodes.map((e=>({...e,x:r,y:a}))),links:e.links.map((e=>({source:{...e.source,x:r,y:a},target:{...e.target,x:r,y:a}})))});function u(t,r,a){let s=t;for(;s;){let t=a.nodes.find((e=>l(s,e)));if(t)return t;s=r.nodes.find((t=>(e.getChildren(t)||[]).some((e=>l(s,e)))))}return a.nodes[0]}function l(t,r){return t.data[e.keyProp]===r.data[e.keyProp]}function p(t,r){return t.source.data[e.keyProp]===r.source.data[e.keyProp]&&t.target.data[e.keyProp]===r.target.data[e.keyProp]}function f(t,r,a){return t+(r-t)*e.easing(a)}return s.useEffect((function(){clearInterval(t);let r=0,a=function(e,t){let r=t.nodes.filter((t=>e.nodes.every((e=>!l(t,e))))).map((r=>({base:r,old:u(r,t,e),new:r}))),a=t.nodes.filter((t=>e.nodes.some((e=>l(t,e))))).map((t=>({base:t,old:e.nodes.find((e=>l(t,e))),new:t}))),s=e.nodes.filter((e=>t.nodes.every((t=>!l(e,t))))).map((r=>({base:r,old:r,new:u(r,e,t)}))),d=t.links.filter((t=>e.links.every((e=>!p(t,e))))).map((r=>({base:r,old:u(r.target,t,e),new:r}))),i=t.links.filter((t=>e.links.some((e=>p(t,e))))).map((t=>({base:t,old:e.links.find((e=>p(t,e))),new:t}))),n=e.links.filter((e=>t.links.every((t=>!p(e,t))))).map((r=>({base:r,old:r,new:u(r.target,e,t)})));return{nodes:a.concat(r).concat(s),links:i.concat(d).concat(n)}}(d,e);t=setInterval((()=>{if(r++,r===e.steps)return clearInterval(t),t=null,void i({nodes:e.nodes,links:e.links});i(function(e,t){return{nodes:e.nodes.map((e=>function(e,t,r,a){return{...e,x:f(t.x,r.x,a),y:f(t.y,r.y,a)}}(e.base,e.old,e.new,t))),links:e.links.map((e=>function(e,t,r,a){return{source:{...e.source,x:f(t.source?t.source.x:t.x,r.source?r.source.x:r.x,a),y:f(t.source?t.source.y:t.y,r.source?r.source.y:r.y,a)},target:{...e.target,x:f(t.target?t.target.x:t.x,r.target?r.target.x:r.x,a),y:f(t.target?t.target.y:t.y,r.target?r.target.y:r.y,a)}}}(e.base,e.old,e.new,t)))}}(a,r/e.steps))}),e.duration/e.steps)}),[e.nodes,e.links]),o.default.createElement(P,n.default({},e,d))}function m(e){return o.default.createElement(y,n.default({duration:e.duration,easing:e.easing,getChildren:e.getChildren,height:e.height,keyProp:e.keyProp,labelProp:e.labelProp,nodeShape:e.nodeShape,nodeProps:e.nodeProps,pathFunc:e.pathFunc,steps:e.steps,width:e.width,gProps:{className:"node",...e.gProps},pathProps:{className:"link",...e.pathProps},svgProps:e.svgProps,textProps:e.textProps},l(e)),e.children)}function b(e){return o.default.createElement(P,n.default({animated:e.animated,getChildren:e.getChildren,height:e.height,keyProp:e.keyProp,labelProp:e.labelProp,nodeShape:e.nodeShape,nodeProps:e.nodeProps,pathFunc:e.pathFunc,width:e.width,gProps:{className:"node",...e.gProps},pathProps:{className:"link",...e.pathProps},svgProps:e.svgProps,textProps:e.textProps},l(e)),e.children)}h.propTypes={source:u.default.object.isRequired,target:u.default.object.isRequired,keyProp:u.default.string.isRequired,x1:u.default.number.isRequired,x2:u.default.number.isRequired,y1:u.default.number.isRequired,y2:u.default.number.isRequired,pathFunc:u.default.func.isRequired,pathProps:u.default.object.isRequired},h.defaultProps={pathFunc:function(e,t,r,a){return`M${t},${e}C${(t+a)/2},${e} ${(t+a)/2},${r} ${a},${r}`}},g.propTypes={x:u.default.number.isRequired,y:u.default.number.isRequired,keyProp:u.default.string.isRequired,labelProp:u.default.string.isRequired,shape:u.default.string.isRequired,nodeProps:u.default.object.isRequired,gProps:u.default.object.isRequired,textProps:u.default.object.isRequired},P.propTypes={children:u.default.node,height:u.default.number.isRequired,keyProp:u.default.string.isRequired,labelProp:u.default.string.isRequired,links:u.default.array.isRequired,nodes:u.default.array.isRequired,nodeClassName:u.default.string,nodeShape:u.default.string.isRequired,nodeProps:u.default.object.isRequired,pathFunc:u.default.func,width:u.default.number.isRequired,gProps:u.default.object.isRequired,pathProps:u.default.object.isRequired,svgProps:u.default.object.isRequired,textProps:u.default.object.isRequired},y.propTypes={getChildren:u.default.func.isRequired,keyProp:u.default.string.isRequired,links:u.default.array.isRequired,nodes:u.default.array.isRequired,duration:u.default.number.isRequired,easing:u.default.func.isRequired,steps:u.default.number.isRequired},m.propTypes={data:u.default.object.isRequired,children:u.default.node,duration:u.default.number.isRequired,easing:u.default.func.isRequired,steps:u.default.number.isRequired,height:u.default.number.isRequired,width:u.default.number.isRequired,keyProp:u.default.string.isRequired,labelProp:u.default.string.isRequired,getChildren:u.default.func.isRequired,margins:u.default.shape({bottom:u.default.number.isRequired,left:u.default.number.isRequired,right:u.default.number.isRequired,top:u.default.number.isRequired}).isRequired,pathFunc:u.default.func,nodeShape:u.default.oneOf(["circle","image","polygon","rect"]).isRequired,nodeProps:u.default.object.isRequired,gProps:u.default.object.isRequired,pathProps:u.default.object.isRequired,svgProps:u.default.object.isRequired,textProps:u.default.object.isRequired},m.defaultProps={duration:500,easing:r.easeQuadOut,getChildren:e=>e.children,steps:20,keyProp:"name",labelProp:"name",margins:{bottom:10,left:20,right:150,top:10},nodeShape:"circle",nodeProps:{},gProps:{},pathProps:{},svgProps:{},textProps:{}},b.propTypes={data:u.default.object.isRequired,animated:u.default.bool.isRequired,children:u.default.node,height:u.default.number.isRequired,width:u.default.number.isRequired,keyProp:u.default.string.isRequired,labelProp:u.default.string.isRequired,getChildren:u.default.func.isRequired,margins:u.default.shape({bottom:u.default.number.isRequired,left:u.default.number.isRequired,right:u.default.number.isRequired,top:u.default.number.isRequired}).isRequired,pathFunc:u.default.func,nodeShape:u.default.oneOf(["circle","image","polygon","rect"]).isRequired,nodeProps:u.default.object.isRequired,gProps:u.default.object.isRequired,pathProps:u.default.object.isRequired,svgProps:u.default.object.isRequired,textProps:u.default.object.isRequired},b.defaultProps={animated:!1,getChildren:e=>e.children,keyProp:"name",labelProp:"name",margins:{bottom:10,left:20,right:150,top:10},nodeShape:"circle",nodeProps:{},gProps:{},pathProps:{},svgProps:{},textProps:{}},e.AnimatedTree=m,e.Tree=b,Object.defineProperty(e,"__esModule",{value:!0})}));
